<html>
<head>
  <title>Plauener Modelleisenbahn</title>
  <meta charset="utf-8"/>
  <style type="text/css"> 
    .Licht_an {
      background-color: yellow;
      font-size: 200%
      }
    .Licht_aus {
      font-size: 200%
      }
    </style> 
<script type="application/ecmascript">
var eventnr=0;
function Logfile(Logtext) {
  var Logfile=document.getElementById("Logfile");
  if (Logfile.hasChildNodes()==false) Logfile.appendChild(document.createTextNode(" "));
  Logfile.firstChild.nodeValue=Logtext;
  }
function SprichDE(was) {
  var worte = new SpeechSynthesisUtterance(was);
  worte.lang = "de-DE";
  window.speechSynthesis.speak(worte);
  }
function SprichFR(was) {
  var worte = new SpeechSynthesisUtterance(was);
  worte.lang = "fr-FR";
  window.speechSynthesis.speak(worte);
  }
function init() {
  //websocket = new WebSocket("ws:192.168.1.123:1880/ws/gpio"); 
  websocket = new WebSocket("ws:192.168.2.101:1880/ws/gpio"); 
  //websocket = new WebSocket("ws:192.168.43.243:1880/ws/gpio"); 
  websocket.onopen = function() {
    Logfile("CONNECTED");
    }; 
  websocket.onclose = function() {
    Logfile("DISCONNECTED");
    }; 
  websocket.onmessage = function() {
    eventnr=eventnr+1;
    Logfile("event.data="+event.data);
    SprichDE("Vorsicht am Gleis 1, es kommt ein Zug aus Chemnitz");
    //SprichFR("Attention à la voie 1, arrivée du train de Chemnitz");
    Logfile("event.data="+event.data+" durch "+eventnr);
    }; 
  websocket.onerror = function() { Logfile("onerror="+event.data) };
  Logfile("Websocket gestartet");
  shutdown_websocket = new WebSocket("ws://192.168.43.220:1880/ws/shutdown");
  shutdown_websocket.onopen = function() {
    }; 
  }

function Test() {
  Logfile("Test gestartet");
  //document.getElementById("Weiche").lastElementChild.tagName.setAttribute("fill","red");
  //alert(document.getElementById("Weiche2").instanceRoot);
  alert(document.getElementById("Weiche2").shadowRoot);
  //alert(document.getElementById("Grafik").pauseAnimations());
  //alert(document.getElementById("Grafik").animationsPaused());
  Logfile("Test beendet");
  }

  </script>
<body onload="init()">
auf GitHub <a href="http://OpaStefanVogel.github.io/WO_IST_MEINE_FERNBEDIENUNG/PLAUENER_MODELLEISENBAHN.html">PLAUENER_MODELLEISENBAHN.html</a>
<p>  letzte Aktion: <span id="Logfile">Seite geladen</span></p>
<p>
Licht
Waldcafe 
<button class="Licht_an" onclick='websocket.send("5");Logfile("Licht ein")'>ein</button>
<button class="Licht_aus" onclick='websocket.send("0");Logfile("Licht aus")'>aus</button>
<button class="Licht_an" onclick='Test()'>Test</button>
<button class="Licht_an" onclick='shutdown_websocket.send("");Logfile("shutdown... gesendet");'>Shutdown Schaltpult</button>
</p>
  <svg id="Grafik" width="800" height="420" viewBox="0 0 800 420" style="border:solid 1px black" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" stroke="darkgrey">
    <title>Streichholzgraph</title>
    <defs>
      <g id="Weiche">
        <!--path d="M0,0 l100,0 M0,20 l100,0 M0,0 A200,200 0,0,1 100,26.8 M0,20 A180,180 0,0,1 90,44.12" fill="none" stroke="red"/-->
        <path d="M5,0.2 A200,200 0,0,1 87.178,20 L5,18">
<animate attributeName="d" from="M5,0.2 A200,200 0,0,1 87.178,20 L5,18" to="M4.9,2.2 A200,200 0,0,1 87.178,20 L4.95,20" dur="0.5" fill="freeze" begin="krumm.click" end="100"/>
<animate attributeName="d" to="M5,0.2 A200,200 0,0,1 87.178,20 L5,18" from="M4.9,2.2 A200,200 0,0,1 87.178,20 L4.95,20" dur="0.5" fill="freeze" begin="gerade.click" end="100"/>
          </path>
        <path d="M100,20 L87.178,20 A200,200 0,0,1 100,26.8" stroke-linejoin="miter" stroke-miterlimit="20" stroke="white" transform="translate(-2,-0.5)"/>
        <path d="M0,0 l100,0 M100,20 L87.178,20 A200,200 0,0,1 100,26.8 M0,20 A180,180 0,0,1 90,44.12" stroke-linejoin="miter" stroke-miterlimit="20"/>
        <circle id="kru" cx="100" cy="-12" r="5" fill="green"/>
        <circle id="ger" cx="90" cy="55" r="5" fill="orange"/>
        </g>
      <line id="Streichholz" x1="0" y1="0" x2="0" y2="100"/>
      <circle id="Streichholzmarkierung" cx="0" cy="0" r="3" />
      </defs>
    <use id="Weiche1" xlink:href="#Weiche" x="200" y="200"/>
    <use id="Weiche2" xlink:href="#Weiche" x="300" y="200"/>
      <g id="Weiche0" transform="translate(100,100)">
        <!--path d="M0,0 l100,0 M0,20 l100,0 M0,0 A200,200 0,0,1 100,26.8 M0,20 A180,180 0,0,1 90,44.12" fill="none" stroke="red"/-->
        <path d="M5,0.2 A200,200 0,0,1 87.178,20 L5,18">
<animate attributeName="d" from="M5,0.2 A200,200 0,0,1 87.178,20 L5,18" to="M4.9,2.2 A200,200 0,0,1 87.178,20 L4.95,20" dur="0.5" fill="freeze" begin="krumm.click" end="indefinite"/>
<animate attributeName="d" to="M5,0.2 A200,200 0,0,1 87.178,20 L5,18" from="M4.9,2.2 A200,200 0,0,1 87.178,20 L4.95,20" dur="0.5" fill="freeze" begin="gerade.click" end="indefinite"/>
          </path>
        <path d="M100,20 L87.178,20 A200,200 0,0,1 100,26.8" stroke-linejoin="miter" stroke-miterlimit="20" stroke="white" transform="translate(-2,-0.5)"/>
        <path d="M0,0 l100,0 M100,20 L87.178,20 A200,200 0,0,1 100,26.8 M0,20 A180,180 0,0,1 90,44.12" stroke-linejoin="miter" stroke-miterlimit="20"/>
        <circle id="krumm" cx="100" cy="-12" r="5" fill="green"/>
        <circle id="gerade" cx="90" cy="55" r="5" fill="orange"/>
        </g>
    </svg>
</body>
  </html>
